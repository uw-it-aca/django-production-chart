{{- if .Values.externalSecrets.enabled }}
{{- $namespace := include "django-production-chart.namespaceIdentifier" . -}}
{{- range .Values.externalSecrets.secrets }}
---
apiVersion: kubernetes-client.io/v1
kind: ExternalSecret
metadata:
  name: {{ .name }}
  namespace: {{ $namespace }}
spec:
  backendType: vault
  data:
{{- $key := .externalKey }}
{{- range .data }}
    - name: {{ .name }}
      key: {{ $key }}
      property: {{ .property }}
{{- end -}}
{{- end -}}
{{- end -}}
